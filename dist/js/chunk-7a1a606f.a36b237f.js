(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7a1a606f"],{"2e99":function(e,t,i){"use strict";i("cd0e")},"36a3":function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"profile__information profile__contant tab-1"},[e.userLoading?a("preloader"):e.user?a("div",{staticClass:"profile__information-row"},[a("div",{staticClass:"profile__information-title"},[a("h2",{staticClass:"profile__information-title-h2"},[e._v(" Персональные данные "),a("span",{staticClass:"profile__information-span secondary",attrs:{title:"Ваш уникальный идентификатор"}},[e._v("#"+e._s(e.user.id))])]),a("span",{staticClass:"profile__information-title-confidentiality"},[e._v(" Ваши данные конфиденциальны, доступ к ним есть только у вас. ")])]),a("div",{staticClass:"profile__information-body"},[a("div",{staticClass:"profile__information-body-row"},[a("info-item",{attrs:{title:"Имя",value:e.user.name,max:150,required:""},on:{change:function(t){return e.saveInfo("name",t)}}}),a("info-item",{attrs:{title:"Номер телефона",value:e.user.phone,phone:!0,required:""},on:{change:function(t){return e.saveInfo("phone",t)}}}),a("info-item",{ref:"emailinput",attrs:{title:"Эл. почта",value:e.user.email,email:!0,required:""},on:{change:function(t){return e.saveInfo("email",t)}}}),a("info-item",{attrs:{title:"Телеграм",value:e.user.telegram,max:32},on:{change:function(t){return e.saveInfo("telegram",t)}}})],1),a("div",{staticClass:"profile__questionnaire-avatar-info-wrap"},[a("div",{directives:[{name:"show",rawName:"v-show",value:!e.userImageLoading,expression:"!userImageLoading"}],staticClass:"profile__questionnaire-avatar profile__questionnaire-avatar-info"},[a("div",{staticClass:"profile__questionnaire-img profile__questionnaire-img-info cursor",on:{click:function(t){return e.$refs["imageinput"].click()}}},[e.src?a("img",{attrs:{src:e.src,alt:""}}):e.user.image?a("img",{attrs:{src:e.user.image,alt:""}}):a("picture",[a("source",{attrs:{srcset:i("4f38"),type:"image/webp"}}),a("img",{attrs:{src:i("7f88"),alt:""}})])]),a("div",{staticClass:"profile__questionnaire-load profile__questionnaire-load-info"},[a("label",{staticClass:"profile__questionnaire-load-button profile__questionnaire-load-button-info"},[a("input",{ref:"imageinput",staticStyle:{display:"none"},attrs:{type:"file"},on:{change:e.uploadImage}}),e._v(" Загрузить фото ")])])]),a("preloader",{directives:[{name:"show",rawName:"v-show",value:e.userImageLoading,expression:"userImageLoading"}],attrs:{height:"200"}})],1)]),a("p",{staticClass:"profile__questionnaire-helper-text secondary"},[e._v("Нажмите на любое из полей, чтобы отредактировать его.")])]):e._e()],1)},s=[],r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"profile__information-item"},[a("div",{staticClass:"profile__information-item-title"},[a("h2",{staticClass:"profile__information-item-title-text"},[e._v(e._s(e.title))])]),a("div",{staticClass:"profile__information-item-data"},[e.edit?a("div",{staticClass:"profile__information-item-data-value"},[a("input",{directives:[{name:"model",rawName:"v-model.trim",value:e.localVal,expression:"localVal",modifiers:{trim:!0}},{name:"click-outside",rawName:"v-click-outside",value:e.offEditMode,expression:"offEditMode"},{name:"mask",rawName:"v-mask",value:e.mask,expression:"mask"}],ref:"input",staticClass:"profile__information-item-data-input",attrs:{type:"text"},domProps:{value:e.localVal},on:{keypress:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.offEditMode(t)},keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"esc",27,t.key,["Esc","Escape"])?null:e.forceOffEditMode(t)},input:function(t){t.target.composing||(e.localVal=t.target.value.trim())},blur:function(t){return e.$forceUpdate()}}}),a("span",{staticClass:"input-btn input-btn-save cursor",attrs:{title:"Сохранить изменения"},on:{click:e.offEditMode}},[e._v(" ✓ ")]),a("span",{staticClass:"input-btn input-btn-close cursor",attrs:{title:"Закрыть окно редактирования"},on:{click:e.forceOffEditMode}},[e._v(" × ")])]):a("div",{staticClass:"profile__information-item-data-info"},[a("p",{staticClass:"profile__information-item-data-text cursor",attrs:{title:"Нажмите для редактирования"},on:{click:e.onEditMode}},[this.phone?[e._v(" "+e._s(e._f("phone")(e.value))+" ")]:e.value?[e._v(" "+e._s(e.value)+" ")]:[e._v(" Пусто ")]],2),a("picture",{on:{click:e.onEditMode}},[a("source",{attrs:{srcset:i("3a51"),type:"image/webp"}}),a("img",{staticClass:"profile__information-item-data-text-change",attrs:{src:i("ae8f"),alt:""}})])]),e.errorMsg?a("div",{staticClass:"errors-box"},[a("span",{staticClass:"red"},[e._v(e._s(e.errorMsg))])]):e._e()])])},o=[],n=i("c28b"),l=i("b5ae"),u={name:"InfoItem",props:{title:{type:String,required:!0},value:{required:!0},max:{type:Number},phone:{type:Boolean,default:!1},required:{type:Boolean,default:!1},email:{type:Boolean,default:!1}},data:()=>({edit:!1,localVal:null,errorMsg:null}),computed:{rules(){const e={};return this.required&&(e.required=l["required"]),this.max&&(e.maxLength=Object(l["maxLength"])(this.max)),this.phone&&(e.maxLength=Object(l["maxLength"])(10),e.minLength=Object(l["minLength"])(10)),this.email&&(e.email=l["email"]),e},mask(){return this.phone?{mask:"8 (999) 999-99-99"}:null}},methods:{onEditMode(){this.edit=!0,this.$nextTick(()=>this.focusInput())},offEditMode(){this.validate()&&(this.value!==this.localVal&&this.emitChange(),this.setBaseState())},forceOffEditMode(){this.setBaseState(),this.freshData()},setBaseState(){this.errorMsg=null,this.$v.$reset(),this.edit=!1},freshData(){this.localVal=this.value},focusInput(){this.$refs.input.focus()},emitChange(){this.$emit("change",this.localVal)},validate(){return this.$v.$touch(),!this.$v.$invalid||(this.setErrors(),!1)},setErrors(){this.$v.localVal.required?void 0===this.$v.localVal.maxLength||this.$v.localVal.maxLength?void 0===this.$v.localVal.minLength||this.$v.localVal.minLength?void 0===this.$v.localVal.email||this.$v.localVal.email||(this.errorMsg="Адрес должен быть в формате Email"):this.errorMsg="Количество символов не должно быть меньше, чем "+this.$v.localVal.$params.minLength.min:this.errorMsg="Количество символов не должно превышать "+this.$v.localVal.$params.maxLength.max:this.errorMsg="Это поле обязательно для заполнения."}},validations(){return{localVal:{...this.rules}}},directives:{clickOutside:n["directive"]},mounted(){this.freshData()}},c=u,m=(i("2e99"),i("2877")),f=Object(m["a"])(c,r,o,!1,null,"7f2ee536",null),d=f.exports,h=i("f152");const p=5e6,v=["image/jpeg","image/png","image/jpg"];var g={name:"ProfileInfo",title:"Мои данные",components:{Preloader:h["a"],InfoItem:d},data:()=>({image:null,src:null,reader:null}),computed:{user(){return this.$store.getters.user},userLoading(){return this.$store.getters.userLoading},userImageLoading(){return this.$store.getters.userImageLoading}},watch:{image(e){e?(this.reader.readAsDataURL(e),this.saveInfo("image",e,()=>{this.$router.push({name:this.$route.name,query:{...this.$route.query,image_loaded:"true"}}),this.$router.go(0)})):this.src=""}},methods:{uploadImage(e){const t=e.target.files[0];if(t){if(!v.includes(t.type))return alert("Картинка должна быть в этих форматах "+v.join(", "));if(t.size>p)return alert("Размер файла не должен превышать "+Math.floor(p/1e3/1e3)+" МБ");this.image=t}},saveInfo(e,t,i=null){let a=!0;const s=this.user[e];"email"===e&&(a=confirm("Вы точно хотите изменить email? После его изменения, его необходимо потвердить.")),a?(this.user[e]=t,this.$store.dispatch("saveUserInfo",{type:e,value:t}).then(()=>{i?i():this.$notify("Новые данные сохранены!"),"email"===e&&setTimeout(()=>{this.$router.go(0)},800)}).catch(t=>{let i=!0;if(t.response&&t.response.data&&t.response.data["errors"]&&t.response.data["errors"]["email"]){const a=t.response.data["errors"]["email"][0];"The email has already been taken."===a&&(alert("Такой email уже занят."),this.user[e]=s,this.$refs["emailinput"].freshData(),i=!1)}i&&(alert("Произошла ошибка отправки формы. Повторите позже."),this.user[e]=s,this.$refs["emailinput"].freshData())})):this.$refs["emailinput"].freshData()}},mounted(){this.reader=new FileReader,this.reader.onloadend=()=>{this.src=this.reader.result}}},A=g,_=Object(m["a"])(A,a,s,!1,null,null,null);t["default"]=_.exports},"3a51":function(e,t){e.exports="data:image/webp;base64,UklGRuoAAABXRUJQVlA4WAoAAAAQAAAAGAAAGAAAQUxQSI8AAAABcFXbdtQcCU/CkxAJSMABcUAdgIPWAXUQCZEQCZHwJDDP8B8RCtO2YZym+xIOyaU+6jGbl1885hakP+SQlTpJkzfkl1faXJvr/sWGZGkI5ug3n9euJtMfNv1h0x82/WHTH/Eu8bO2+h3Mrfsib6OGNuY4QNmbBccRtFTgEMArkSMkgPjdDwkdgMZ+VxYEAABWUDggNAAAABADAJ0BKhkAGQA+XSSNRaOiIRv0ADgFxLSAAFY3NIuk9AD+8pEJS//vetivwLFVvOAAAAA="},ae8f:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAAZCAMAAADzN3VRAAAAUVBMVEUAAACvr6+/v7+3t7e/v7+6urq/v7+7u7u8vLy/v7+9vb2/v7+9vb2/v7+9vb29vb29vb29vb2/v7++vr69vb2/v7++vr6+vr6+vr6+vr6+vr5qu/KUAAAAGnRSTlMAEBAgIDAwQFBfYG9wf4CPkJ+foK+vv8/f7/AMRU4AAACOSURBVCjPvdHNEoMgDEbRD7BosWp/KJC8/4N2kVEhpdve7RmSAYBOl8zJdYGCvacurIDlHsTiMGeYpRwFGYW1zOTxeI1HVgCI5AEe1HIAV/IA+Bc00kAtLVSi4BQNp6TbDi60Qn4/MZZGHMEtMkrJxERRdigZpuNHlFT9W+y3ZHmUzSgw8Sn3SKyitwWADzxMDBATBp/HAAAAAElFTkSuQmCC"},cd0e:function(e,t,i){}}]);